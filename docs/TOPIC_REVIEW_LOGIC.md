# ๐ Topic Review System: The "Smart Focus" Blueprint

**ุงููุฏู:** ุชูููู ุงูุทุงูุจ ูู ูุฑุงุฌุนุฉ ููุถูุน ูุญุฏุฏ (Topic) ุจุฐูุงุกุ ูุบุงูุงุช ุชุซุจูุช ุงูุญูุธ ุฃู ุงูุชุญุถูุฑ ูุงูุชุญุงูุ ุฏูู ุชูุฑุงุฑ ููู ูุจุฏูู ุงุณุชุบูุงู ููุธุงู ุงูููุงุท.

---

## 1. ูุชุทูุจุงุช ุงูุจูุงูุงุช (Schema Prerequisites) ๐๏ธ

ูุจู ุงูุจุฏุกุ ูุฌุจ ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงูุญููู ุงูุชุงููุฉ ูู ุงูุฏุงุชุงุจูุฒ:

1.  **`Player Memory Tracker`:**
    *   ุฅุถุงูุฉ ุญูู `topic` (Link: Game Topic).
    *   *ุงููุฏู:* ููู ูุณุชุทูุน ุชูููุฐ ุงุณุชุนูุงู `WHERE topic = X`.
2.  **`Gameplay Session`:**
    *   ุงูุชุฃูุฏ ูู ุชุฎุฒูู `topic` (ูู ุงูู raw data ุฃู ูุญูู ูููุตู) ุนูุฏ ุงููุนุจุ ูุบุงูุงุช ุญุณุงุจ "ุนุฏุฏ ูุฑุงุช ุงููุฑุงุฌุนุฉ ุงูููููุฉ".

---

## 2. ุฎูุงุฑุฒููุฉ "ุงูุงุฎุชูุงุฑ ุงูุฐูู" (The Smart Selection Algorithm) ๐ง

ุนูุฏูุง ูุทูุจ ุงูุทุงูุจ ูุฑุงุฌุนุฉ ุชูุจูู `Topic-A`:

### ุฃ. ุญุฌู ุงูุฌูุณุฉ (Dynamic Sizing)
ุงููุธุงู ูุญุณุจ ุฅุฌูุงูู ุงูุฃุณุฆูุฉ ุงููุชุงุญุฉ ูู ูุฐุง ุงูุชูุจูู (ุงูุชู ูุนุจูุง ุงูุทุงูุจ ุณุงุจูุงู).
*   **ุงููุงุนุฏุฉ:** `10%` ูู ุงูุฅุฌูุงูู.
*   **ุงูุญุฏูุฏ:** `Min = 10`, `Max = 30`.
    *   *ูุซุงู:* ุชูุจูู ููู 15 ุณุคุงู -> ุงูุฌูุณุฉ 10 ุฃุณุฆูุฉ.
    *   *ูุซุงู:* ุชูุจูู ููู 500 ุณุคุงู -> ุงูุฌูุณุฉ 30 ุณุคุงูุงู.

### ุจ. ููุทู ุงูุชุตููุฉ (Priority Queue)
ูููู ุงููุธุงู ุจุฌูุจ ุงูุฃุณุฆูุฉ ูุชุฑุชูุจูุง ุญุณุจ ุงูุฃููููุฉ ุงูุชุงููุฉ (ุงูุฃุนูู ูุงูุฃุฏูู):

1.  **๐ด ุงูููุทูุฉ ุงูุญูุฑุงุก (Critical):**
    *   ุงูุฃุณุฆูุฉ ุงูุชู `stability = 1` (ุฃุฌุงุจูุง ุฎุทุฃ ุณุงุจูุงู ุฃู ูุณููุง).
    *   *ุชุธูุฑ ุฏุงุฆูุงู ุญุชู ูู ุฑุงุฌุนูุง ูุจู ุฏูููุฉ.*
2.  **๐ ุงูููุทูุฉ ุงูุจุฑุชูุงููุฉ (Due):**
    *   ุงูุฃุณุฆูุฉ ุงูุชู ุญุงู ููุนุฏูุง (`next_review <= NOW`).
3.  **โช ุงูููุทูุฉ ุงูุจูุถุงุก (Unseen Today):**
    *   ุงูุฃุณุฆูุฉ ุงูุชู `stability > 1` (ุฑุงุณุฎุฉ) ูููู `last_review < Today` (ูู ูุฑูุง ุงูููู).
4.  **๐ซ ุงููุญุธูุฑุงุช (Blocked):**
    *   ุงูุฃุณุฆูุฉ ุงูุชู ุฃุฌุงุจูุง **ุตุญ** ุงูููู (`last_review == Today` AND `stability > 1`).
    *   *ูุชู ุงุณุชุจุนุงุฏูุง ุชูุงูุงู ุฅูุง ูู ุญุงูุฉ "ููุงุฐ ุงููุฎุฒูู".*

---

## 3. ุงูุชุตุงุฏ ุงูุฎุจุฑุฉ (The XP Economy) ๐

ูููุน ุงูู "Grinding" (ุฅุนุงุฏุฉ ููุณ ุงูุชูุจูู ุงูุณูู ููุณุจ ููุงุท)ุ ูุทุจู **ูุงููู ุงูุชูุงูุต**:

ุงููุธุงู ูุญุณุจ: *ูู ูุฑุฉ ูุนุจ ุงูุทุงูุจ "ูุฑุงุฌุนุฉ" ููุฐุง ุงูุชูุจูู ุงููููุ*

| ุฑูู ุงูุฌูุณุฉ ููููู | ูุนุงูู ุงูู XP | ุงูุฑุณุงูุฉ ุงูุถูููุฉ |
| :--- | :--- | :--- |
| **ุงูุฃููู** | **100%** | ุฃุญุณูุช! ุซุงุจุฑ. |
| **ุงูุซุงููุฉ** | **50%** | ููุชุงุฒุ ุฃูุช ูุฌุชูุฏ. |
| **ุงูุซุงูุซุฉ ูุฃูุซุฑ** | **10%** | (ุฑูุฒู ููุท) ููุฏ ุฎุชูุช ุงููุงุฏุฉุ ุงุฑุชุญ ููููุงู. |

---

## 4. ุชุฏูู ุงููุณุชุฎุฏู (The User Flow) ๐ถโโ๏ธ

### ุงููุฑุญูุฉ 1: ููุทุฉ ุงูุฏุฎูู (Entry Point)
*   **ุงูููุงู:** ุฏุงุฎู ุงูู Modal/Sheet ุงูุฐู ูุธูุฑ ุนูุฏ ุงูุถุบุท ุนูู "ุงููููุจ" (Topic) ูู ุงูุฎุฑูุทุฉ.
*   **ุงูุดุฑุท:** ุฒุฑ "ุฑุงุฌุน ูุฐุง ุงูููุถูุน" ูุธูุฑ ููุท ุฅุฐุง ูุงู ุงูุทุงูุจ ูุฏ ุฃููู **ุฏุฑุณุงู ูุงุญุฏุงู ุนูู ุงูุฃูู** ูู ูุฐุง ุงูุชูุจูู.

### ุงููุฑุญูุฉ 2: ุงููุนุจ (Gameplay)
*   ูุงุฌูุฉ `ReviewSession` ุงูุนุงุฏูุฉ (ุนุฏุงุฏ ููุชุ ูููุจูุ ุฃุณุฆูุฉ ุณุฑูุนุฉ).

### ุงููุฑุญูุฉ 3: ุงูุฅุบูุงู ู "ุชุฃุซูุฑ ูุชููููุณ" (The Loop) ๐
ุนูุฏ ุงูุชูุงุก ุงูุฌูุณุฉุ ุงูุจุงู-ุฅูุฏ ูุฑุณู ูู ุงูุฑุฏ ุญููุงู ุงุณูู `remaining_items`.

**ุงูุณููุงุฑูู ุฃ: (ูุง ุฒุงู ููุงู ุฃุณุฆูุฉ)**
*   **ุงูุญุงูุฉ:** `remaining_items > 0`.
*   **ุงูุดุงุดุฉ:** ุนุฑุถ ุงูู XP ุงูููุชุณุจ + ุฒุฑ ุจุงุฑุฒ: **"ุฃููู ุงููุฑุงุฌุนุฉ (ุจูู 20 ุณุคุงู) โก๏ธ"**.
*   **ุงูุชุตุฑู:** ุถุบุทุฉ ุงูุฒุฑ ุชุจุฏุฃ ุฌูุณุฉ ุฌุฏูุฏุฉ ููุฑุงู ุจูุนุงููุฑ "ุงูุฌููุฉ ุงูุซุงููุฉ" (ุชุณุชุจุนุฏ ูุง ุชู ุญูู ูู ุงูุฌููุฉ ุงูุฃููู).

**ุงูุณููุงุฑูู ุจ: (ุชู ุชูุธูู ุงูุชูุจูู)**
*   **ุงูุญุงูุฉ:** `remaining_items == 0`.
*   **ุงูุดุงุดุฉ:** ุงุญุชูุงู ูุจูุฑ ๐ + ุฑุณุงูุฉ: **"ุฃูุช ุฃุณุทูุฑุฉ! ุฃุชููุช ูุฑุงุฌุนุฉ ูุฐุง ุงูููุถูุน ููููู."** + ุฒุฑ "ุนูุฏุฉ ููุฎุฑูุทุฉ".

---

## 5. ุณููุงุฑูููุงุช ุงูุญุงูุฉ (Edge Cases) โ๏ธ

### ุณ1: ุงูุทุงูุจ ูู ูููู ุงูุชูุจููุ ูู ูุฑุงุฌุนุ
*   **ูุนู.** ูุฑุงุฌุน ููุท ุงูุฏุฑูุณ ุงูุชู ุฃููุงูุง. ุงูุฃุณุฆูุฉ ุงูุฎุงุตุฉ ุจุงูุฏุฑูุณ ุงููุบููุฉ ูุง ุชุธูุฑ ูู ุงูู Pool.

### ุณ2: ุงูุทุงูุจ "ุฎุชู" ุงูุชูุจูู ุงูููู (ุญู ูู ุดูุก ุตุญ) ูุถุบุท ูุฑุงุฌุนุฉ ูุฑุฉ ุฃุฎุฑูุ
*   ุงููุธุงู ูุฌุฏ ูุงุฆูุฉ "ุงูุฃููููุงุช" ูุงุฑุบุฉ.
*   **Fallback Logic:** ููุชูู ุงููุธุงู ููุถุน **"ุงููุฑุงุฌุนุฉ ุงูุดุงููุฉ"**. ูุฌูุจ 10 ุฃุณุฆูุฉ ุนุดูุงุฆูุฉ ูู ุงููู (ุญุชู ูู ุญููุง ุงูููู)ุ ููู ูุนุทู ุนูููุง **10% XP** ููุท.

---

### โ ููุฎุต ุงูุชูููุฐ (Action Plan)

1.  **Database:** ุฅุถุงูุฉ `topic` ูู `Player Memory Tracker`.
2.  **API:**
    *   ุชุญุฏูุซ `submit_session` ูุชุนุจุฆุฉ ุงูู `topic`.
    *   ุฅูุดุงุก `get_topic_review_session` (ุฃู ุชุญุฏูุซ ุงูุฏุงูุฉ ุงูุญุงููุฉ ูุชูุจู `topic_id`).
    *   ุชุญุฏูุซ `submit_review_session` ูุชุฑุฌุน `remaining_count`.
3.  **Frontend:**
    *   ุฅุถุงูุฉ ุงูุฒุฑ ูู `TopicDetailsModal`.
    *   ุชุนุฏูู `ReviewCompleteScreen` ูุฅุธูุงุฑ ุฒุฑ "ุฃููู ุงููุฑุงุฌุนุฉ".
